# vguards.spec
# -*- mode: python ; coding: utf-8 -*-

block_cipher = None

# Path to the Nmap scripts directory
nmap_path = 'C:\\Program Files (x86)\\Nmap'

a = Analysis(
    ['vguards.py'],
    pathex=['.'],
    binaries=[],
    datas=[
        ('icon.jpeg', '.'),
        ('about_updated.html', '.'),
        ('helpdocs.html', '.'),
        ('res/*', 'res',),
        ('scripts/httprecon/get_existing/*', 'scripts/httprecon/get_existing'),
        ('scripts/httprecon/get_long/*', 'scripts/httprecon/get_long'),
        ('scripts/httprecon/get_nonexisting/*', 'scripts/httprecon/get_nonexisting'),
        ('scripts/httprecon/head_existing/*', 'scripts/httprecon/head_existing'),
        ('scripts/http-lexmark-version.nse', 'scripts'),
        ('scripts/httprecon.nse', 'scripts'),
        ('scripts/http-vulners-paths.txt', 'scripts'),
        ('scripts/http-vulners-regex.json', 'scripts'),
        ('scripts/http-vulners-regex.nse', 'scripts'),
        ('scripts/pjl-info-config.nse', 'scripts'),
        ('scripts/samba-vuln-cve-2012-1182.nse', 'scripts'),
        ('scripts/smb-vuln-ms10-054.nse', 'scripts'),
        ('scripts/smb-vuln-ms10-061.nse', 'scripts'),
        ('scripts/smb-vuln-ms17-010.nse', 'scripts'),
        ('scripts/smtp-vuln-cve2020-28017-through-28026-21nails.nse', 'scripts'),
        ('scripts/vulners.nse', 'scripts'),
        ('scripts/vulscan.nse', 'scripts'),
        ('scripts/vulscan-db/cve.csv', 'scripts/vulscan-db'),
        ('scripts/vulscan-db/exploitdb.csv', 'scripts/vulscan-db'),
        ('scripts/vulscan-db/openvas.csv', 'scripts/vulscan-db'),
        ('scripts/vulscan-db/osvdb.csv', 'scripts/vulscan-db'),
        ('scripts/vulscan-db/scipvuldb.csv', 'scripts/vulscan-db'),
        ('scripts/vulscan-db/securityfocus.csv', 'scripts/vulscan-db'),
        ('scripts/vulscan-db/securitytracker.csv', 'scripts/vulscan-db'),
        ('scripts/vulscan-db/xforce.csv', 'scripts/vulscan-db'),
        (nmap_path, 'nmap'),
        
    ],
    hiddenimports=[
        # Add any hidden imports that vulscan or other scripts require
        'nmap', 'lxml', 'pyotp', 'qrcode', 'sqlite3', 'smtplib', 'ssl',
        'email.mime.text', 'email.mime.multipart', 'email.mime.image', 'email.mime.base', 'email.encoders'
    ],
    hookspath=[],
    runtime_hooks=[],
    excludes=[],
    win_no_prefer_redirects=False,
    win_private_assemblies=False,
    cipher=block_cipher,
)

pyz = PYZ(a.pure, a.zipped_data, cipher=block_cipher)

exe = EXE(
    pyz,
    a.scripts,
    [],
    exclude_binaries=True,
    name='vguards',
    debug=False,
    bootloader_ignore_signals=False,
    strip=False,
    upx=True,
    upx_exclude=[],
    runtime_tmpdir=None,
    console=True,  # Set this to False to hide the console
    icon='icon.jpeg'  # Add your icon file here
)

coll = COLLECT(
    exe,
    a.binaries,
    a.zipfiles,
    a.datas,
    strip=False,
    upx=True,
    upx_exclude=[],
    name='vguards',
)

app = BUNDLE(
    coll,
    name='vguards.exe',  # This name is for macOS, Windows uses .exe
    icon='icon.jpeg',
    bundle_identifier=None
)
